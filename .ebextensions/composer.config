commands:
  composer_update:
    command: export COMPOSER_HOME=/root && /usr/bin/composer.phar self-update 2.1.8
  permission_to_folder:
    command: "sudo chmod a+x -R /var/app/staging/"
  02_give_permission_to_hooks:
    command: "sudo chmod a+x -R /var/app/staging/.platform/hooks"

option_settings:
  - namespace: aws:elasticbeanstalk:application:environment
    option_name: COMPOSER_HOME
    value: /root

  # Point the app root to the public/ folder.
  - namespace: aws:elasticbeanstalk:container:php:phpini
    option_name: document_root
    value: /public

  # Set here your php.ini `memory_limit` value.
  - namespace: aws:elasticbeanstalk:container:php:phpini
    option_name: memory_limit
    value: 256M

container_commands:
  03_give_permission_to_write:
    command: "chmod a+x -R /etc/php.d/"
    cwd: "/var/app/staging"

  05_clear_config:
    command: "php artisan config:clear"
    leader_only: true